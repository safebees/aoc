import {type Coordinate, findIndicesByChar, forEach, getAmountChar, logMatrix, replaceAll} from "../../utils.ts";

let s = `........5..................................e..3...
.......q...........m................e.............
....m.......................................e.....
.........................................C........
.u.m........................8.....................
...........7......9.......8...........F...s.......
6...q..............................s..............
..................................................
..................................................
..................................................
..........9....................F..................
.................................M....D...........
.........U........................................
..q................................8..............
.......9..........................................
0....6.....................e..Qs...............F..
.................................Q...D............
.0.u....................................2.........
..................................................
........u................Q........................
.....E........1...................................
...n....v....................................3....
......u..0................N.......................
............................................z.....
.........7....U.........4.....Z...Q.....D.....V...
..............n1.........f.................2......
E.............................f..............z....
...E........1.Z.......U......................D....
.......n...v....7Z...N............................
..........7..N.....Zf...........................3.
................................b............V....
............4..................................9..
..n...v........................5................2.
.........v.................5.........S............
..........................s.......................
.....U.........4..C.....................S..V......
..................................................
......................c........b............M.....
...........4.Wc....d.......1.....b.....S..........
..E........c............................5......z..
..............w..C....................SM.2........
........................d.........................
...............c......C3..........................
...............w....W.............................
..................................................
.........d.......B....w...........................
....B.....W.......dw..........................M...
...............W......................N...V.......
.B................................................
....................B...............b.............`

const matrix = s.split('\n').map(line => line.split(''));
const antinodesMatrix = s.split('\n').map(line => line.split(''));

forEach(matrix, (char, {x, y}) => {
    if (char === '.') {
        return;
    }
    for (const coordinate of findIndicesByChar(matrix, char)) {
        if (!(coordinate.x === x && coordinate.y === y)) {
            extracted(coordinate, y, x);
            replaceAll(antinodesMatrix, char, '#')
        }
    }
});

function extracted(coordinate: Coordinate, y: number, x: number) {
    const antinodesY = y + (coordinate.y - y) * -1;
    const antinodesX = x + (coordinate.x - x) * -1;
    if ((antinodesMatrix[antinodesY] ?? [])[antinodesX]) {
        (antinodesMatrix[antinodesY] ?? [])[antinodesX] = '#';
        extracted({x: x, y: y}, antinodesY, antinodesX);
    }
}

logMatrix(antinodesMatrix)
console.log(getAmountChar(antinodesMatrix, '#'));