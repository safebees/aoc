import {type Coordinate, findIndicesByChar, getAmountChar, logMatrix} from "../../utils.ts";

let s = `........5..................................e..3...
.......q...........m................e.............
....m.......................................e.....
.........................................C........
.u.m........................8.....................
...........7......9.......8...........F...s.......
6...q..............................s..............
..................................................
..................................................
..................................................
..........9....................F..................
.................................M....D...........
.........U........................................
..q................................8..............
.......9..........................................
0....6.....................e..Qs...............F..
.................................Q...D............
.0.u....................................2.........
..................................................
........u................Q........................
.....E........1...................................
...n....v....................................3....
......u..0................N.......................
............................................z.....
.........7....U.........4.....Z...Q.....D.....V...
..............n1.........f.................2......
E.............................f..............z....
...E........1.Z.......U......................D....
.......n...v....7Z...N............................
..........7..N.....Zf...........................3.
................................b............V....
............4..................................9..
..n...v........................5................2.
.........v.................5.........S............
..........................s.......................
.....U.........4..C.....................S..V......
..................................................
......................c........b............M.....
...........4.Wc....d.......1.....b.....S..........
..E........c............................5......z..
..............w..C....................SM.2........
........................d.........................
...............c......C3..........................
...............w....W.............................
..................................................
.........d.......B....w...........................
....B.....W.......dw..........................M...
...............W......................N...V.......
.B................................................
....................B...............b.............`

// let s = `............
// ........0...
// .....0......
// .......0....
// ....0.......
// ......A.....
// ............
// ............
// ........A...
// .........A..
// ............
// ............`

const matrix = s.split('\n').map(line => line.split(''));
const antinodesMatrix = s.split('\n').map(line => line.split(''));

for (let y = 0; y < matrix.length; y++) {
    for (let x = 0; x < matrix[y].length; x++) {
        const char = matrix[y][x];
        if (char !== '.') {

            let indicesByChar = findIndicesByChar(matrix, char);
            handle(indicesByChar, y, x)
        }
    }
}

function handle(indicesByChar: Coordinate[], y: number, x: number) {

    for (const coordinate of indicesByChar) {
        let yDistance = coordinate.y - y;
        let xDistance = coordinate.x - x;
        if (xDistance === 0 && yDistance === 0) {
            continue;
        }

        let yDistanceCoo = y + yDistance * -1;
        let xDistanceCoo = x + xDistance * -1;
        if ((antinodesMatrix[yDistanceCoo] ?? [])[xDistanceCoo]) {
            (antinodesMatrix[yDistanceCoo] ?? [])[xDistanceCoo] = '#';
        }
        logMatrix(antinodesMatrix)
    }
}

console.log(getAmountChar(antinodesMatrix, '#'));