import {
    allDirections,
    type Coordinate,
    type Coordinates, type CoordinateValue, type Direction, distinct,
    forEach,
    getCordinate,
    getNeighbourCordinates, groupBy, MultiMap, removeItem,
    sameCoordinate, sort, splitToSequences
} from '../../utils';

let s = `YYYYYYYYYYYYYYYYYYYYYYYGGGGGGGGGGGSSSSSSSSSSSSSSSSSRRRRRRRZXXXXXUUUUUUUSSRRRRRRRRRRRRRRRRRRRRRRRVVVVVSSSSSSSOOOOOOOOOOOOOOOBBPPPPPPPPPJJJJJJ
YYYDDDYYYYYYYYYYYYYYYYGGGGGGGGGGGXXSSSSSSSSSSSSSSSRRRRRRRRZXXXXUUUUUUUUUURRRRRRRRRRRRRRRRRRRRRRRRVVVGSSSSSSSOOOOOOOOOOOHOOOOPPPPPPPPPJJJJJJJ
YYYDDDDYDYYYYYYYYYYGGYGGGGGGGGGGGXSSSSSSSSSSSSSSSSZRRRZZZZZZXXXUUUUUUUUUUQRRRRRRRRRRRRRRRRRRRRRRRVDGGSSTTTTSOOOOOOOOOOOHHOOOPPPPPPPPPPJJJJJJ
YYYYYDDDDDDDDYYYYYYYGGGGGGGGGGGGGSWSSSSSSSSSSSSSSSZZZZZZZZZZZZZUUUUUUUUUUURRRRRRRRRRRRRRRRRRRRRRGGGGGSTTTTTTOOHOAOOOOOOHHHHHVVPPPPPPQQYYYYJJ
YIIDYYDDDDDDDYYYYYYYGGGGGGGGGGGGSSSSSSSSSSSNNNSNNZZZMZZZZZZZZZZUUUUUUUUUUURRRRRRRRRRRRRRRRRRRRGGGGGGGGTTTTHHHHHOAOAOOOOHNNNHVVPPPPPYQYYYYYYJ
IIIDDYYDDDDDYYYYYYYYYGGGGGGGGGGSSSSSSSSSSSSNNNNNNNZZZZZZZZZZZZUUUUUUUUUUUUUUURRRRRRRRRRRRRRRRRGGGGGGGGTTTTTHHHHOAAAOOOHHHHHHHPPPYYYYYYYYYYYY
IIIDDYDDDDDDDDYYYYYYYYGGGGGGGGGSSSSSSSSSSSNNNNNNNNNNNZZZZZZZZZUUUUUUUUUUUUUUUURRWRRRRRRRRUUGRGGGGGGGGGTTTTTHHHAAAAAOOOHHHHHHHEPPYYYYYYYYYYYY
IIIDDDDDDDDDDYYYYYYYGGGGGGGGGGGGSFSSSSSSSSSNNNNNNNNNNNZUZZZZZZZZUUUUUUUUUUUUUUYYRRRRRRRUUUUGRGGGGGGGGYTTTTTHHHHHHAAOOOHHHHHHHEEYYYYYYYYYYYYY
IIDDDDDDDDDDDYYYYYYGGGGGGGGGGGGGZFSSSSSSSSSSSSNNNNNNNNNNZZZMZZZUUUUUZZZZZZZZZZYYYYRRRRRUUUGGGGGGGGGGGTTTTHHHHHHHHAOOHHHHHHHHHEAAYYYYYYYYYYYY
IIDIIDDDDDDDDYYYYYYGGGGGGGGGGGGTFFFFSSSSSSSSSSNNNNNNNNNNZZMMZZZUUUUUZZZZZZZZZZYYYYYUUUUUUUGGGGGGGGGGHHHTTTHHOOOOOOOOOHHHHHHHHEYYYYYYYYYYYYYY
IIIIIDDDDDDDDYYYYYYYGGGGGGGGGGGGGFFFSLLSSSSSBBNCNNNNNNNNNZMZZZUUUUUUZZZZZZZZZZAAYYYAUUUUUUUUGGGGGGGGHHHHHTHHOOOORROOHHHHNHHEEEEEEYYYYYYYYYYY
IIIIIDDDDDDYDYYYYCYGGUUUGGGGGGGGGFFFFLLLFFPSSSCCCNNNNNNINNMZZPUTTTTUZZZZZZZZZZAAAAAAUUUUUUUGGGGGGGGGGBHHHRHHHHHRRROHHHHNNNNNNEEEEEEYYYYYYYYY
IIIIIIDDDDDYYYYYCCCCCCCGGGGGFFFFFFFFFFFFFFPPSCCCCNNNNNNINMDDDDUDTTTTZZZZZZZZZZAAAAXXUUUUUUUUGGGGGGBBBBHHHRRRRRRRRRRFHHNNNNNNNNEEEEEEEYFYYYYY
IIIIIIIDDDDDYYYCCRCCCCCCOOOFFFFFFFFFFFFFFFFCCCCCCCENNWWIDDDDDDDDTTTZZZZZZZZZZZAAAAXXUUUUUUUUUUGGGBOBBBBRRRRRRRRRRRFFFFNNNNNNNNNEEEEEEXYYYYQQ
IIIIDDDDDDDDDDWQCCCCCCCCCCCFFFFFFFFFFFFFFFFCCCCCCCCNJWWIDDDDDDDDTTTZZZZZZZZZZZAAAAXXUXUTTTUUUUUBNBBBBBRRRRRRRRRRRRRFFNNNNNNNNNNNCEEEEEYQQYQQ
IIIIIDDDDDDSWWWWCCCCCCCCCCCFFFFFFFFFFFFFFCCCCCCCCCCRWWWWDDDDDDDDDDVZZZZZZZZZZZAAAAXXUUUATTTUUTUBNBBBBRRRRRRRRRRRRRPNNNNNNNNNNNNNCEEEEYYYQQQQ
IIIIIIDDSSDSWWWWCCCCCCCCCCCFFFFFFFFFFFFFFCCCCCCCCCCCWWWUDDDDDDDDVVVVZZZZZZZZZZAAAAXXUUUTTTTTTTTBBBBBBBRRRRRRRRRPPPPNNNNNNNNNNNNCCCCEEEQQQYQQ
IIIIIIDDSSSSWWCCCCCCCCCCCCFFFFFFFFFFFGCCCCCCCCCCCCCWWWWWDDDDDDVVVVVVZZZZZZZZZZAAAXXXXXTTTTTTTTTBBBBBBBBRRRRORRRRPPNNNNNNNNNNNNNRCCSCEQQQQYQQ
IIIIIIDSSSSSSSSCCCCCCCCCCCFFFFFFFFFFGGGGCCCCCCCCCCCWWWVVDDDDDDDVVVVVWNNNZZZZZNAAJJJJXTTTTTTHHTTBBBBBBBBRRRRRRRRRPPPNNNNNNNNNNNRRCCCCQQQQYYQQ
IIIIIISSSSSSSSCCCCCCCCCCCZFUFFFFFFFFGGGGGCCCCCCCCCCWWWWVVVVVDDVVVVVVVNNNZZZZZNNNJJJJJTTTTTHHHBBBBBBBBBBRBRTTRRVVRPPNNNNNNNNNNPCCCCCCQQQYYYYQ
IIIIIASSSSSSSSCCCCCCCCCZZZZFFFNFNNFFGGGGGCCCCYCCCCCWWWVVVVVVVDDVVVVVVSSNZZZZZNNNJJJJJJJJTHHHHBBBBBBBBBBBBRTTRRRRRRPPNBNNNNNNNNCCCCCCQQQQQYYQ
IAIAAASSSSSSSRRCCCCCCCCZZZZNNNNNNNCCGGGCCCCCCYCCCOOOOVVVVVVVVDVVVVVVVVSNZZZZZNNNNJJJJJJPTHHHHBBBBBBBBBBBBBBBVEREEEEEBBNNNNNNNCCCCCCQQQQQQYYQ
AAAAAAASSSSSSSCCCCCCCCCCCZNNNNNNNCCCCCCCCCCCCYCOOOOOOOOOVVVVVVVVVVVVVESNZZZZZNNNJJJJJJJJHHHHHBBBBBBBEBBBBBBBVEEEEEEEGGGGYGGNCCCCCCCCCQCQQYQQ
SAAAAAAAAASSSSSCCCCCCCCKCNNNNNNNNCCCCCCCCCYYYYCOOOOOOOOOVVVVVVVVVVVEEEECZZZZZNNJJJJJJJJJJJHHHBBBBBBBBBBBBBBEEEEEEEEEEGGGGGGGGCCCCCCCCCCCQQQQ
AAAAAAAAAAASAIACCCCCCCKKKKNNNNNNNCCCCCCCCCYYYYYOOOOOOOOOVVVVVVVVVVVEEEEEZZZZZJNJJJJJJJJJJJHHHHBAABBBBBBBBBBEEEEEEEEEGGGGGGGGGCCCCCCCCCCCQQQQ
AKAAAAAAAAAAAAAYYCYCYCKTTTTNNTNNXXXCCCCCCYYYYYYOOOOOOOOOVVVVVVVVVEEEEEEEZZZZZJJJJJJJJJJJHHHHHHHBBBBBBBBBBBBBEEEEEEEEEGGGGGGGGCCCCCCCCCCCQQQQ
AAAAAAAAOOAAAAAAYYYYYCCTTTTTTTTXXXXXCYYCVYYYYYYOOOOWWWWWWWWVVVCCCCCEEEEEEJJJJJJJJJJJJJJJHHHHHHHBBBBBBBBBBBBBEEEEEEEEEGGGGGGGGGGCCCCCRRRCQQQQ
NANNAAAAOAAAAAAAYYYYYTMTTTTTTTTTXXXXXYYYYYYYYYYOOOOWWWWWWWWCCCCCCCCEEEEEETJJJJJJJJJJJJEHHHHHHHHHHBBBBBBBBBBEEEEEEEEEEGGGGGGGGGGGCCRRRRRCQQQQ
NNNNAAPPPPPAAAAAYYYYYTTTTTTTTTXXXXXXXXYYYYYYYYYOOOOWWWWWWWWCCCCCCCCCEEEETTJJTJJJJJEJJQEEEHHHHHHHBBBBBBBBBBBEEEEEEEEGGGGGGGGGGGGGBCCRRRJJJQQJ
NNNNAAPPPPPAAAAAYYYYYTTTTTTTTXXXXXXXXKKKDYYYYYYCCOOWWWWWWWWCCCCCCCCCCCCCCTTTTJJJJJEEEEEEEHHHHHHHHBBBBBBBBBBEEEEEEEEEGGGGGGGGGGGBBCCCRJJJJJJJ
NNNNNAPPPPPAAAAAYYYYTTTTTTTTTTXXXXXYKKKKYYYYYYYCCCCWWWWWWWWCCCCCCCCCCCCCTTTTTTTTJJEEEEEEEEEHHHHHBFBBBBBBBBBBEEEEEEEEEEEGGGGGGCCJJJJJJJJJJJJS
NNNNBBPPPPPAAAAPPYYYTTTTTTTTTTXXXXYYYYYKYYYYYYCCCCCWWWWWWWWWWWWCCCCCCCCCTTTTTTTTTTZEEEEEEHHHHWWHBBBBBBBBBBBBEEEEEEEEEEOOGGGGGGJJJJJJJJJJJJJS
NNNNNPPPPPPPAPPPPYYYTTTTTTTTTTXXXXXXXYYYYYYYYYCCCCOWWWWWWWWWWWWCCCCCCCCCTTTTTTTTTZZEEEEEEHWWWWWHBBBBBBBBBBBBKEEEEEEEEEOGGGGGGGGJJJJJJJJJJJJJ
NNNNNNPPPPPPAPPPPPYYYYTTTTTTTTXXXXXXXYYYYYYYYCCCCCOWWWWWWWWWWWWCACCCCCCCCTTTTTTTTEEEEEEEEEPPPWWHHHBHBBBBOOOOEEEEEEEEEOOGGGGYYYYJJJJJJJJJJJJJ
NNNNNNPPPPPPPPPPPYYYYYTTTTTTTTTMMMXMXXYYYYYYYCCYCCOWWWWWWWWWWWAAACCCQTCCTTTTTTTTTJEEEEEEQWWWWWWWHHHHHHBBOEOOSEEEEEEEEESSYYYYYYYJJJJJJJJJJJJJ
NNNNNNNNPPPPPPPPPYYYYYETTTTTTTTMMKMMMMYYYYYYYYYYCCOWWWWWWWWWWWAAACLLTTCTTTTTTTTTJJJJEEEEEWWWWWWWWHHHEEEEEEEOSSSEEEEEEESSSYYYYYYYJJJJJJJJJLLJ
NNNNYNPPPPPPPPPPPPYYEEEETTTTTTMMMMMMMMYZYYYYYGGGCCOOOOWWWWWWWWAAAATTTTTTTTTBTTTTTJJJJEWWWWWWWWWWWHHHHEDGEEEESSEEEESSESSSFSYYYYYYJJJJJJJJJLZZ
NANNYYYPPPPPPYYYYPYYEEETTTTTTTMMMMMMOOYZYYYYYGGGCCOOOOOWWWWWWWKAAATTTTTTTBBBBBBTTJJJJEWWWWWWWWWWHHHHHGGGGEESSSSSESSSSSSSSSSYYYYYYHJHHJJJJLLL
NANNYYYPPPPPPPYYYYYKEEEETTTTTMMMOMMOOYYYYYYYYKKKKCOOOOOWWWWWWWKAATTTTTTBBBBBBBBBJJJTJWWWWWWWWWWWHHHHHGGGGGGASSSSSSSSSSSSSSYYYYYYHHHHHJJJLLLL
VVEVYYYYYPPPPPYYYYYKEEEETTTTTTTMOOOOOOYFYYYYYKKKKKKKKKKWWWWWWWKKATTTTTTTBBBBBBBBJJJTJWWWWWWWWRRRRRRHHGGGGGGGSSSSSSSSSSSSSSYYYYYYHHHHJJJJLLJL
VVVVYYYYYYPYYFYYKKKKEKKTTTTTTTLMMOOOOOOYYYYYDDKKKKKKKKKWWWWWWWKKAAAZTTQQBBBBBBBBJJJTTLLLLLLLLLLRRRRHHGGGGGGGGGGSSSSSSSSSSSYYYYHYHHHHJJJJJJJJ
VVVVVYYYYYYYYFFYKKKKKKKKKKZZTGMMMMOOOOOCYCCYDDKKKKKKKKKWWWWWWWKAAZZZTTQQBBBBBBBBBBTTTLLLLLLLLLLRRRRGGGGGGGGGGGGSSSSSSSSSSSYYHHHHHHHHJJJJJFJJ
VVVVYYYYYYYFYFFFKKKKKKKKZZZWGGGMMMOOONNCCCCCDKKKKKKKKKKKKKKKAAAAZZZZTTTQBBBBBBNBBTTTTLLLLLLLLLLRRRRGGGGGGGGGGGGSSSSSSSSSFSSSHHHHHHHHHFFFJFFJ
VVVVVVFFYYFFFFFFYYKKKKKEEEZWWGGMMNNNNNFFCCCCDKKKKKKKKKKKKKKKKAAZZZZZZTQQBBBBBNNBBTTTTLLLLLLLLLLRRRRRGGGGGGGGGGGSSSSSSSFFFFSGHHHHHHHHHFFFFFFJ
VVVVVFFFFFFFFFFFKKKKKKKEEEEEEEEEENNNNNFNNCVVVVVVKKKKKKKCCKKKKKAZZZZZZZQBBBBBBNNBTTTTTLLLLLLLLLLRRRRRGGGGGGGGGGSSSSSSLFFFFFFGHHHHHHHHHHFFFFFF
VVVVVFFFFFFFFFFFKKKKKKKEEEEEEEEEENNNNNNNNVVVVVVVVVKYCCKCCCCZKSZZZZZZZZZTTBBBBBBTTTTTTLLLLLLLLLLRRRRRAGGGGGGGGGSSLLLLLFFFFFFFFHHHHHHHHHHFFFFF
VVVVVFFFFFFFFFFKKKKKKKKEEEEEEEEEENNNNVNNNVVVVVVVVVKKKCCCCCZZZZZZZZZZZZZZTBBBTTTTTTTTTLLLLLLLLLLRRRRYNGNNGGGGGSSLLLLLLLFFFFFFFFHHHHHHHHFFFFFF
VVVVVVFFFFFFFFFKKKLLLLLLEEEEEEEEENNNNVNVVVQVVVVVVVCCCCCCCCZZZZZZZZZZZZZZBBBTTTTTTTTTTLLLLLLLLLLRMMNNNNNNNGGGGGGLLLLLLLLLFFFFFFHHHHHHHHFFFFFZ
VVVVVVFFFFFFFFFKKELLLLLLEEEEEEEEEWWNNVVVQQQQQVVCVVCCCCCCZCZZZZZZZZZZZZZZPBBZTTTTTTTTPLLLLLLLLLLMMNNNNNNNNGGGGGGGGGGLLLLLLLFFFFFHHHHHHHFFFFZZ
VVVVVVFFFFFFFFNNKELLLLLLEEEEEEEEEWWWNVVVQQQQQVVCFFCCCCCCZZZZZZZZZZZZZZPPNZZZZTTTTTTTTLLLLLLLLLLMMMNNNNNNNNGGGGGGGGGLLLLLLLFFOAFFHZHZZHFFFFZZ
VVVVVFFFFFFFFFNNZELLLLLLEEEEEEEEEWFFVVVVQQQVVVCCCCCCCCCCZZZZZZZZZZZZZZGPNZZZZTTTTTTTTTPPPYYYYMMMMNNNNNNNNNNNNGGGGLLLLLLLLLFAAAFFHZZZZZZZFZZZ
VVVVVFFFFFFFNNNLLLLLLLLLLEEEEEEEEFFFVVVVVVQKKVCCCCCCCCCCZZZZZZZZZZZZZZGNNZZZZTTTTTTTTYOPMMYYYYMMMNNNNNNMNMMMMMMGGLLLLLLLLLAAAAAAAAZZZZZZZZZZ
VVVFFFFFFFFFNNNLLLLLLLLLLEEEEEWWWFFVVVVVVVQQKVCKCKCCCCCCCZIIZIZZZZFZZGGGNGZZTTTTSTTTTOOOMYYYYYMMMNNMNNMMMMMMMMMLLLLLLLLLLLAAAAAAAAAZAZZZZZZZ
VVVVVVFFFFFNINNLLLLLLLLLLEEEEEWWDFFFFTTVTTTTKKKKKKCCCCCCCCIIIAZZZZFFZGGGGGZZTTTSSSTTTOOMMYYYMYMMMNMMNNNMMMMMMMWOLLLLLLLLLLAAAAAAAAAAAZAZZZZZ
VVVVVVFFJJJNNNNLLLLLLLLLLLEEEEWDDFFFTTTTTTCTKKKKKCCCCCCCCCCAIAAZZZFFFFFFFGTTTTOSOOOQOOOOMMMYMYMMMMMMMMMMMMMIIMWWLWWWWWWLLAAAAAAAAAAAAAAZZZZZ
VVVVVVVFJLLLLLLLLLLLLLLLLLEWWWWDDFFFTTTTTTCTKKKKKKCDBCCCCAAAAAAAAFFFFFEFFFTTTTOOOOOOOOOOMMMMMMMMMMMMNMMMMMMMIIIWWWWWWWLLAAAAAAAAAAAAAAAZZZZZ
VVVVVVVFVLLLLLLLLLLLLLLLLLEWWWWWDFXXTTTTTTTKKKKKKDDDDCCCCCBBAAAFFFFFFEEEEFFFMCOOOOOOOOOOOMMMMMMLLLNNNNNNNNRNIIIWWWWWWWWAAAAAAAAAAAAAHAWWZZZZ
VVVVVVVVVLLLLLLLLLLLLELLLEEWWWWWWYXYTTTTTTTTKKKKKKDDDDDCDBBAAAAFFFFFEEEZEFFFMOOOOOOOOOOOOMMMMKKLLNNNSNNNNNNNNNNWWWWWWWWAAAAAAAAAAAAAAAWWZZWZ
VVVVVVVVXLLLLLLLLLLLLELLLEENWWYYYYYYTSTTTTTKKKKKKHIDDDDDDBAAAAAAFAFFEEEEYMMMMMNNOOOOOOOOOXMMKKKLLLNNNNNNNNNNNNWWWWWWWWWWAAAAAAAAAAAAAAWWWWWZ
VVVVVVVVWLLLLLLLLLLLLJLLLNNWWWWYYYYYYYTTTTTKKKKKHHHDDDDDDBAAAAAAAAEFEEEMMMMMMMMMOOOOOOOOXXXXOKKKKLLLNNNNNNNNNWWWWWWWWWWAAAAAAAAAAAAAWWWWWWZZ
VVVVVVWWWLLLLLLLLLLLLJLLLNWWWWWYYYYYYTTTTTOOOOOKHHHHDDDDKAAAAAAAAZEEEEEMMMMMMMMMMOOOOOOOYXBKKKKKKLLNNNNNNNNNNWWWWWWWWWWAAAAAAAAAAAAWWWWWWWWW
VVAVVVWWWWWWWLLLLLLLLJLLLRWRWWWYYYYYYYTTTFOOOOOOOHHNBBDDAAAAAAAAAEEEEEEERMMMMMMMMOOOOOXOXXXKKKKKKLLLNNNNNNMWWWWWWWWWWWWWWDDDAAAAWWWWWWWWWWWZ
AAADVVWWVWWWWWJJJJJJJJJNRRRRRRYYYYYYYYTTFFTOOOOOONNNBBDAAAAAAAAAAWEEEEEMMMMMMMMMMMOOOOXXXXXKKKKKKNNNNNNNNMMWWWWWWWWWWWWWWWDAAWWWWWWWWWWWWWZZ
AAAAAAAAWWWWWWWWWJJJJJJRRRRRRRRYYYYYYYTTTTTTOOOODBBBBBBBAAAAAAAARWEEEEEMMMMMMMMMMMMXXXXXXXOKKKKKKKKNNNNNNNYWYYWWWWWWWWWCWDDWAWWWWWWWWWWWWWWZ
AAAAAAAAZWWWWWWWJJJJJJJRRRRRRRRRYYYYYYYGGTKKKOOBBBBBBBBBAAAHHAARRRRRRRRMMMMMMMMMMMMXXXXXXXOKKKKKKKKENNNNNNYYYYWWWWWWWWWWWWDWWWWWWWWWWWWWWWZZ
AAAAAAAAWWWWWWWWJJJJRRRRRRRRRRRRYRRRYYYGGGGOOOOBBBBBBBBBBAHAAASRSRRRRRRMMMMMMMMMMMMMXXXXXXXXXKKKKKKKNNYYNYYYYWWWWWWWWWWWWDDWWWWWWWWWWWWWWWWW
AAAAAAIAAWWWWWWWJJJJJRRRRRRRRRRFFRRFGGGGGGGPPPBBBBBBBBBBBHHHHHSRSRKRRRRRRMMMMMMMMMMMMMXXXXXXXKKKKKKKKYYYYSSSSDFWWWWWWWWZRDWWWWWWWWWWWWWZZWWW
AAAAAAAAAAWWWWWWJJJJJRRRRRRRRRRFFRFFGGGGGGGPPPPBBBBBBJBBBHHHHHSSSRRRRRRRRRMMMMMMMMMMXXXXXXXXXXKKKKKKKYYYDSSSSDFFFFRWRWZZRJJWJWWWWWWWWWWWZZZZ
AAAAAAAAAWWWWWWWJJJJJRRRRRRRRFFFFFFFFGGGGGGGGPPBBBBBBBBBBHHHHHSSRRRRRRRRRRRRRMMMMMMMXXXXXXXXKKKKKKKKKSSSSSSSSDFRRRRRRWRRRRJJJWWJWWWWWWWWWZZZ
ZZAAAAAAAWZWWWWWWJJJRRRRRRRRRFFFFFFFFGGGGGPPPPPBBBBBBBBHBHHHHHRRRRRRRRRRRRRRRMMMMMTMXXXXXXXXKKKKKKKYKSSSSSSSSDDDRRRRRRRRRRRRJJJJJWWJJJJWZZZZ
ZZAAAAAAAWZZWWWWWWJJRRRRRRRFFFFFFFFFGGGGGGGGPPPPBBBBBBBHHHHHHHHRRRRRRRRRRRRRRMMMXXXXXXXXXXXXXXKKKKKYYSSSSSSSSDDDDRRRRRRRRRRRRJJJJJJJJJJZZZZZ
ZZZAZZAAZZZZZWWJJJJJRRRRRRFFFFFFFFFFFFGGGGGPPPPBBBBBBBPHHHHHHHHHRRRRRRRRRRRRRRRRXXXXXXXXXXXXXXKKKKYYYSSSSSSSSDDDDEEERRRRRRRRRRJJJJJJJJJZZZZZ
ZZZZZZAAZZZZZWJJJJJJJRJRRRJFFFFFFFFFFGGGGPPPPPPBBBBBBBBHHHHHHHRRRRRRRRRRRRRRRROXXXXXXXXXXXXXXXXXXXXYYYDDDSSSSDDDDEEERRRRRRRRRJJJJJJJJJJZZZZZ
ZZZZZZZAZZZZZWJJJJJJJRRRRRJJJFDFFFFFBGGGWWWPPWPBBBBBHHHHHHHHHHHRRRRRRRRRRRRRRROOXXXXXXXXXXXXXXXXXXYYYYDSSSSSSDDDDEEEERRRRRRLLLLLLJJJJJJZZZZZ
ZZZZZZZZZZZZZWWJJJJJJJJRRRJJJFFFFFFBBGWWWWWWPWWBRBBBBBHHHHHHHHHRRRRRRRRRRRRRRROOXXXXXXXXXXXXXXDDDDDDYYDSSSSSSDDDEEEEERRERRRLLLLLLJJJJJJZZZZZ
ZZZZZZZZZZZZZWPPPPJJJJJJJJJJJJFFGFFFFFWWWWWWWWWRRBBBBBHHHHEEHHHRHHRRRNRNNVRRVVVVVVXXXXXXXXXXXXXDDDDDDFFSSSSSSDDEEEEEEEEERRLLLLLLLLLLLLJZZZZZ
ZZZZDDDZZZZZZWPPPKJJJJJJJJJJJGGGGGFFIIIWWWWWXWWWBBBBBBHHHHEEHHHHHHRRRNNNNVVVVVVVVVYYXXXXXXPOXXXDDDDDDDFSSSSSSDFFFEEEEEEELRLLLLLLLLLLLLZZZZZZ
ZZZDDDZZZZZQQPPPPKJJJJJJJJJJJJJGGGGIIIIWWWWWWWWWBBBBBBQQQEEHHHHHHKKRNNNNJVVVVVVVVYYXXXXXXKPOOODUUUUUUUUSSSSSSFFFEEEEEEEELRLLLLLLLLLLLLJZZZZZ
ZZZZDDZZZZZQPPPPPPJJJJJJJJJJJJGGGGGIIIIWWWWWWWAWJBBBBBQQQEEEUHHKKKNRRNNNNNLVVVVVVYYXXXPPPPPPOODUUUUUUUUSSSSSSFIFEEEEEEEELLLLLLLLLLLLLLZZZZZZ
ZZDDDDRRZPPPAPPPPPPPPPPPJJJJJJGGGGGGGIIWWWWWWWAWWFBBMMEEEEEEEHHKKNNNNNNNNNNVRVVVVVXXWXPPPPPPPOOUUUUUUUUSSSSSSIIEEEEEIEEEILLLLLLLLLLLLLZZZZZZ
ZDDDDDDRPPPPPPPPPPPPPPPPJJJXXJXXGGGGXPPPWWWWWWAAAFFFMMEEEEEEEHDNNNNNNNNNNNWVVVVVVVWXWPPPPPPPPPOUUUUUUUUSSSSSSIIIIIIIIIIIILLLLLLLLLLLLLZZZZZZ
DDDDDDDDBPPPPPPPPPPPPPPPJJJJXXXXXGGGXMPPWWWWWWAAAAFMMMMEEEEEEEENNNNNNNNNNNWWVWVWVWWWWPPPPPPPPOOUUUUUUUUSSSSSSIIIIIIIIIIIILLLLLLLLLLLLLZZZZZZ
DDDDDDDDDPPPPPPPPPPPPPPPJJJJXXXXXXGMMMRPPWWWWAAAAMMMMMMMMEEEEEEXNNNNNNNNNWWWWWWWWWWPPPPPPPPPPPPUUUUUUUUUUUUUUUIIIIIIIIIIILLLLLZZJZZJZZZZZZZZ
DDDDDDDDDYDPPPPPPPPPPPPPJJXXXXXXXXXPMMXWWWWWWAMCAMMMMMMMMEEEEEXXXNNNNNNNGGWWWWWWFWWWPPPPPPPPPPPUUUUUUUUUUUUUUUIIIIIIIIIIIIILLLLZZZZZZZZZZZZZ
DDDDDDDDDDDPPPPPPPPPPPPPJXXXXXXXXXXXKXXWWWWWWWWCMMMMMMMMMEEEEEEXXXNNNNNGGGGWWWFFFFFWPPPPPPPPPPPUUUUUUUUUUUUUUUIIIIIIIIIIIIMMMMMMZZZZZHHZZZZZ
DDDDDDDDDDDPPPPPPPPPPPPPJXXXXXXXXXXXXXXWXWWWWWWCCCMMMMMMMMEEEEEXXXNGGGNGGGGGWWFFFFFFFPPPPPPPPPPUUUUUUUUKFUUUUUIIIIIIIIIMIMMMMMMZZZZZZHHHHHHZ
DDDDDDDDDDTHPCPPPPPPPPXXXXXXXXXXXXXXXXXWXXXXXXXCCCCMMMMHHHEEEEEXXXFGGGGGGGGGGFFFFFFFFPFPPPPPPPIUUUUUUUUKFUUUUUIIIIIIIIIMMMMMMMMMMMZZHHHWHHHH
DDDDDDDDDDDHHHPPPPIPPPXXXXXXXXXXXXXXXXXXXXXXXXXCCCCMMHMHHHHEEEEXFFFGGGGGGGGEEEFFFFFFFFFPPPPPPPIIIUUUUFKKKUUUUUIIIIIJIEIMMMMMMMMMMMMMFHHHHHHH
DDDDDDDDDHHHHHHPIIIIIIXXXXXXXXXXXXXXXXXXXXXCCCCCCCCMMHHHHHHHHHFFFFFFGGGGGGEEEEFFFFFFFFFPPPPPPPPIIUUUUKKKKKKKKIIIMIMMIIMMMMMMMMMMMMMMHHHHHHHM
DDDDDDDDDHHHHHPPPIIIIIXXJJXXXXXXXHXXXXXXXXXCCCCCCCCVAHHHHNNNNNNNNNNFGGGGGXKEEEFFFFFFFFFPPPPBIIIIIUUUUKKKKKKKKMMMMIIMMMMMMMMMMMMMMMMMHHHHHHHH
DDDDDDDDDHHHHHIIIIIIIIXXOOOXXXXXXHHRQXXXXXGCCCCCCCCAAAHHHNNNNNNNNNNNNNNGIKKKEEFFFFFFFFFFFPCIIIIIIUUUUKKKKKKKKKMMMBMMMMMMMMMMMMMMMHHHHHHHHHHH
DDDDDDDDHHHHHHHHHHIIIIIOOOOXXXXXXHRRQXXXXXGCCCCCCCCCAAAAHNNNNNNNNNNNNNNKKKKKKFFJJFFFFFFFFNIIIIIIIUUUUKKKKKKKMMMMBBBBBMMMMMMMMDMMHHHHHHHHHHHH
DZDDDDDHHHHHHHHHHHHIIIIIOOOOXXOOOHRRRRXXXXCCCCCCCCCAAAAAANNNNNNNNNNNNNNKKKKKKKFFJFFFFFFFFNNNIIIIIKKKKKKKKKKKMMMBBBBBBBMMMMDDVDMMHHHHHHHHHHHH
HZDDHDDHHHHHHHHHHIIIIIIIOOOOOOOOOORRRXXXNCCCCGCCCCCAAAAAANNNNNNNNNNNNNNKKKKKKKKKKOOOFFFFNNNNIIIIIIKKKKKKKKKKMMMBBBBBBBMMMMDDDDDDDDDDHHHHHHHH
HHHHHLLHHHHHHHHIHIIIIIIIOOOOOOOOOORMRRXXXCCCCCCCCCAAAAAAANNNNNNNNNNNNNNKKKKKKKKKJOOFFFFFNNNNIIIIIIIKKKKKKKKKMMMBZBBBBMMMMMDDDDDDDDDHHHHHHHDH
BBBHAHHHHHHHHHHIIIIIIIQQOOOOOOOOOOOMRQQQCCCCCCCCCAAAAAAAANNNNNNNNNNFFFKKKKKKKKJJJOFFFFFFFFNCCIIIIKKKKKKKKKMMMMMBBBBBBMMMDDDDDDDDDDDHHHHHHDDD
BBBHHHHHHHHHHHIIIIIIIPIQQOOOOOOOOORRRQQQCCCCCCCCCCCAAAAAANNNNNNNNNNFFJJKJKKKKJJFFFFFFFFFFFNCCCCIIIKKKKKKKKKKMLBBBBBBBBBTDDDDDDDDDDDHHHHHDDDD
BBBBBBHHHHHHHHHIIIIIIIIQQQOOQOQQQQQQQQQQCCCCCCCCCCCCAAAAANNNNNNNNNNJJJJJJKJKKJJJSFFFFFFFFFFFCCIIIKKKKKKKKKKKMLLLLBBBBBBBDDDDDDDDDDDDDDDDDDDD
BBBBBBBBHHIIIHIIIIIIIIIQQQQOQOQQQQQQVQCCCCCCCCCCCCCCAAAAANNNNNNNNNNJJJJJJJJJJJJJFFFFFFFFJFFFCCICIIIIKKUKKKKKLLLLLBBBBBBDDDDDDDDDDDDDDDDDDDDD
BBBBBBNHHNNIIIIIIIIITTQQQQQQQQQQQQVVVCCCCCCCCCCCCCCCAAAAAAAAAARRRRRJJJJJJJJJJJJJFFFFFFFFFFCCCCCCIIIUUUUKKKKLLLLLLLBBBBBZDDDDDDDVVDVDDDDDDDDD
BBBBBNNNNNNNNIIIIIIITTTQQQQQQQQQQVVVVVVVCCCCCCCCCCCXXAAAAAAAARRRRRJJJJJJJJJJJJJJPPFFFFFFWFCCCCCCCCCVVUUUUUUULLLLLLLLBKBDDDDDDDVVVDVVDDDVDDDD
BBBBNNNNNNNNIIIIIIIITTTTHHQQQQQQQQVVVVVVVVVCCCCCCCCCXAAAAAAARRRRRRRRJJJJJJJJJJJJPFFPPFFFCCCCCCCCCCCVVVMMUUULLLLLLLLLLLLDDDDDVVVVVVVVVVVVDDDD
BNNNNNNNNNNIIIIIIIIITTTTTHQQQQQQQVVVVVVVVVVVCVVCCCCKKKAAAAAAAARRKRRRJJJJJJJJJJJJPPFFPFFFCCCCCCCCCCRMMMMMUUUUULLLLLLLLLLLYDDVVVVVVVVVVVVVVVDD
BNNNNNNNNNNENIIIIIITTTTTTHQHQQQQQVVVVVVVVVVVVVVCVVCKKKKKKAAGKKKKKRRJJJJJJJJJJJJJJPPPPFFCCCCCCCCCCCMMMMMMMBMUMMLLLLLLLLYYYDYYVVVVVVVVVVVVVVDD
BNNNNNNNNNNNNIIIIIIIITTTTHHHHYYQQQQVVVVVVVVVVVVVVVCCKKKKKKAKKKKKKRRJJJJJUUJJJJJJJJPPPPFCCCCCCCCCCCMMMMMMMBMMMKLLLLDDDDDDDDYYVVVVVVVVVVVVVDDD
BNBBNNNNNNNNNNIIIIIIIIFTHHHYYYYQQQQVVVVVVVVVVVVVVVCCVVKKKKKKKKKKKRRRUUUJUUUJJJJJPPPPPXTCCCCCCCCCEMMMMMMMMMMMBLLLLLDDDDDDDDYVVVVVVVVVVVVVVVDD
BBBBNNNNNNNNNNIIIIIIIIFFHHHHHHQQQQLLLLLVLVVVVVVVVVVVVKKKKKKKKKKKKRUUUUUUUUUJJJJJJPXXXXTTCCCCCCCCCMMMMMMMMMMMBLLLLLDDDDDDDDYVVVVVVVVVVVVVVVVV
BBBBBNNNNNNNNNIINIIIIIFHHHHHHQQQQQQLLLLLLVVVVVVVVVVKKKKVKKKKKKKKKKJUUUUUUUUJJJJJJPPPXXXTCCCCCCCCCCMMMMMMMMMBBLLLJLDDDDDDDDYSSVVVVVUVVVVVVVVV
BBBNNNNNNNNNNNNNNNIIIFFHJJJJJJJJJJQLLLLLLLVVVVVVVVVVVKKKKKKKKKKKKUUUUUUUUUUUULLLJPLXXXXXAACCCCCCCCMMMMMMMMMBLLLLLLDDDDDDDDSSVVVVVVUVVVVVVVVC
BBBNNNNNNNNNNNNNNRRRFFFHJJJJJJJJJJLLLLLLLLVVVVVVVVVVKKKKKKKKKKKKKUUUUUUUUUUUUULLLLLXXXXXXACCCCCDCCAMMMMMMMMMLLSSLLDDDDDDDDSVVVVVVUUVVUCCUCCC
BBBNNNNNNNNNNNNNRRRRRHHHJJJJJJJJJJLLLLLLLJJVVVVVVVVKKKKKKKKKKKKKKUUUUUUUUUUUUULLLLXXXXXXXAACEEEUUUUUMUUMMMUUULUSSSDDDDDDDDDDVVVVVUUUVUCCUCCC
BBBBYYNNNNNNNNNNRRRRRRHHJJJJJJJJJJLLLLLLLJGTGVVVVVKKKKKKMKKKKKKKUUUUUUUUUUUUUULLLLXXXXXAAARRRREUUUUUUUUUUUUUUUUUSSSSSSSDDDDDVEVVVUUUUUUUUUCC
BBBBBYNNNNNNNNNCFRRCRRHAJJJJJJJJJJLLLLGGGGGGGJKVKKKKMMMMMKKKKKKKUUUUUUUUUUUUUULLLLLXXXXAARRRRUUUUUUUUUUUUUUUUUUUSSSSSSSDDDDDEEVVUUUUUUUUCCCC
BYYYYYYYNNNNNNNCCCCCRRRHJJJJJJJJJJLLLGGGGGGGGGKVKKKKMMMMMMMMKKKKUUUUUUUUUUUUUUUXXXXXXXXRRRRRRRUUUUUUUUUUUUUUUUSSSSSSSSSDDDDDEEVIUUUUUUUUUUCC
BYYYYYYYYYYNNNNCCCCCCRRRJJJJJJJJJJLLLWGWGGGGGKKKKMMKKMMMMMMMMKKKUUUUUUUUQUUUUUUXXXXXXXXXXRRRRRUUUUUUUUUUUEEUUUSSSSSSSSSSSSSSSEUUUUUUUUUUUUUC
BYYYYYYYYYXONNNCCCCCCCRRJJJJJJJJJJLWWWWWGGGGKKKKKMMKMMMMMMMMMMKKUUUUUUUQQQQUUXXXXXXXXXXRRRRRRRRRRUUUUUUUUEEUEUSSSSSSSSSSSSMMMUUUUUUUUUUUUUUU
YYYYYYYYOOOONNCCCCCCCDDDDDGJJJJJJJLWWWWGGCCCKKKKKKMMMMMMMMMMMKKKKSUUUXEEEEEENXEXXXXXXXXRRRRRRRRRUUUUUUUEUUEEEEESSESESSSMMMMMMMMUUUUUUUUUUUUG
YYYYYYYYOOOOOCCCCCCCCDDDCCGJJJJJJJWWWWWWWWCCCKKKKMMMMMMMMMMMMKKKKSSUXXEEEEENNEEEEXXXXXRRRRRRRRRRUUUEEEEEEEEEEEEESEEEEMMMMMMMMMMUUUUUUUUUUUUG
GYYYYYYXOOOOOOCCCCCCCCDDCCGGGGGGGGWWWWWWWWWCCKKFKMMMMMMMMMMMMMKKKKSSEEEEEEEEEYEEXXXXXRRRRRRRRRRRUUEEEEEEEEEEEEEEEEEEMMMMMMMMMMMUUUUUUUUUUUGG
GYYYOTYOOOOOOSOCCCCCCCCCCCGGGGGGGWWWWWWWWWCCZZZFFMDMMDDDDMMWWKKKRLLEEEEEEEEEEEEEXXXXXXXXRRRRRRJJUJJJJEEEEEEEEEEEEEEEMMMMMMMMMFUUUUUUUUUUUUGG
GGGOOOOOOOOOOOOOCCCCCCCCCCCCGGGGGGWWWWWWWCCCZZZFDADDMMDDDMWWLLKKKLLEEEEEEEEEEEEEEEXXXXRRRRRRRRRJJJJJJEEEEEEEEEEEEEEMMMMMMMMMMFGGGGGUGUUUJJJG
GGGGOOOOOOOOOOOOCCCCCCCCGGGGGGGGGGWWWWWEZZZZZZZFDDDMMDDDDDDLLLKKLLLEEEEEEEEEEEEEEEEXXRRXRRRRRRRRRJJJJJJEEEEEEEEEEEEEEMMFFFFFFFGGGGGGGUGGJJGG
GGGOOOOOOOOOOOCCCCCCCCCCCGGGGGZGGZWWWWWEZZZZZZZDDDDDDDDDDDULLLLKLLLLEEEEEEEEEEEMEXEXXXXXRLRRRRRRRJJJEJENNEEEEEEEEEEEEMMFFFFFFFFGGGGGGGGGJGGG
GGGGOOOOOOOOOOOCCCCCCCCCGGGGGGZZZZZWWWWWZZZZZZZZDDDDDDDDDDUULLLLLLLEEEEEEEEEEEEEXXEXXXXXXXRRRRRMEEEJEEENEEEEEEEEEEEEEMMFFFFFFAAGGGGGGGGGGGGG
GOGGOOOOOOOOOOOOCCCCCCCCGGGGGGGGZZZWWWWEZZZZZZZDDKDKDDDDDDLLLLLLLLEVEEEEEEEEEEEEXXXXXXGGXGGYGRMMEEEEEEEEEEPEEEEEEEEELFFFFFFFFFAGGGGGGGGGGGGG
OOOOOOOOOOOOOOOOCCCCCCTCGGGGGGGZZZZWWWZZZZZZZZZZDKKKDDDEEEELLLLLLLEEEEEEEEEEERRXXXXXXXXGGGGGGBEEEEEEEEEEEEEEEEEEYEEEEEFFFFFFFYGGGGGGGGGGGGGG
QQOOOOOOOOOOOOOTTTCTTCTCTGGGGGZZZZZZWWZZZZZZZZZZKKVVVHDCEEKLLLLLCCCECECEEEEEERUUNMMMMMGGGGGXEEEEEEEEEEEEEEEEEEEEYEFFFFFFFFFFGGGGGGGGGGGGGGGG
QKOOOOOOOOOOTOTTTTTTTTTTTGGGGGZZZZZZZZZZZZZZZZZZZVVVVVVCEEEEEEEECCCECCCCEEEEEUUUNNMMMMMMGGGXXEEEEEEEEEEEEEEEUEEEEEFFFFFFFFFFFGGGGGGGGVGGGGGG
QKKOOOOOOOTTTTTTTTTTTTTTTTTTTWWZZZZZZZZZZZZZZZZZMVVVVVVVVEEEEECEUCCCCCCCEUNEUUUUUUMMMMMGGGXXXLLEEEEEEEEEEEEEEMMZZZFZFFFFFFFFFGGGGGGGGGGLGGGG
QKKKKKKKKTTKTTTTTTTTTTTTTTTTPWZZZZZZZZZZZZZZZPZHVVVVVVVVVEEEEVCCCCCCCCCCEUUUUUUUUMMMMMMGXXXXLLLEEEEEEEEEEEEEMMZZZZZZFFFFFFFFFGGGGGGGGGGGGGGG
KKKKKKKKKKTTTTTWWTWTTWWTTTTTTWZZZZZZZZZZZZVPQPHPPVVVEVVVEEEEEEEECCCCCCCCCCUUUUUUUFFFMMMWMXLLLLLLLLEEEEEEEEEMMZZZZZZZFFFFFFFFFGGNGGGGGGGGGGGG
KKKKKKKKKKTTTTTWWWWWWWWWTTTTWWZZZZZZZZZPPPPPPPPPPEVVEVEEEEEEEECCCCCCCCCCCCUMUUUUUUMMMMMMMLLLLLLLLLLEEEEEEEMMMMZBZZZZZZFFFFFFFFFGGGGGGGGGGGGG
KKKKKKKKKKTTTTTWWWWWWWWWWWWWWWWZZZZZZZZPPPPPPPPPPEEEEEEEEEEEEECCCCCCCCCCCCUMMUUUUUMMMMMLLLLLLLLLLLLLEEEEEEEEMMZZZZZZZZZFFFFFFFFFGGGGGGGGGGGG
VKKKKKKKKKTTWWWWWWWWWWWWWWWWWWWWZZZZZZZPPPPPPPPPPEEEEEEEEEEEECCCCCCCCCCCCCMMMMUMUUFFMMMLLLLLLLLLLLLLEEEEEEMMMZZZZZZZZZZFFFFFFFFFGGGGGGGGGGGG
KKKKKKWWWTTWWWWWWWWWWWWWWWWWWWWWZZWWWZZPPPPPPPPPEEEEEEEEEEEEEECCCCCCCCCCCCCMMMMMOFFFMLLLLLLLLLLLLLLAEEEEEEMMMMZZZZZZZZFFFLLLFFFFGGGGGGGGGGGI
KKKKKKKWWWWWWWWWWWWWWWWXWWWWWWWWWWWWWWPPPPPPPPPPEEEEEEEEEEEEEEEECCCCCCCCCCCCCMMMOFFFMLJLLLLLLLLLLLLAAAVMEEEMMMMZZZZZZZZFFLLLFFFFFFGGGGGGGIGI
KKKKKKWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWPPPPPPPPEEEEEEEEEEEEEEEEEECCCCCCCCCCOOMOOOFOOMJJLLLLLLLLLLLLLAVVVVMMMMMZZZZZZZZFFELLLLFFFFFFGGGIGIIII
KKKKKWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWPWPPPPPEEEEEEEEEEEEEEEEEEECCCCCCCFCCOOOOOOOOOOJJLLLLLLLLLVVLLAVVVVMMMMMZZZZZZZZZFELLLLFFFFFIIGGIIIIII
KKKKWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWPDDPEEEEEEEEEEEEEEEEEEEECCCCCCFCXOOOOOOOOOJJJJLLVLLVVLVLLLVVVVVMMMMMMMMZZZZZZZEELLLFFFFIIIIIIIIIII
KKKWWWWWWWWWWWWWWWWWWWXWWWWWWWWWWWWWWWWWWWWWWWWEEEEEEEEEEEEEEEEEEECCCCCCCNOOOOOOOOOOJJJJJLVVVVVVVVVVVVVVVMMMMMMMMMMZZZZEEEEELFFIIIIIIIIIIIII`

let matrix = s.split('\n').map(line => line.split(''));

interface ECoordinate extends Coordinates {
    fuucounter: number;
    fences: { x: number, y: number, direction: Direction }[];
    e: string;
}

const all: ECoordinate[][] = [];

forEach(matrix, (e, c) => {
    if (all.some(s => s.some(c1 => sameCoordinate(c1, c)))) {
        return;
    }
    let items = bla(c, e, []);
    if (items.length !== 0) {
        all.push(items);
    }
});

function bla(c: Coordinate, element: string, coordinateValues: ECoordinate[]): ECoordinate[] {
    if (coordinateValues.some(c1 => sameCoordinate(c1, c))) {
        return coordinateValues;
    }

    let coo = {e: element, ...c, fuucounter: 0, fences: []};
    coordinateValues.push(coo);
    for (const allDirection of allDirections) {
        let neighborCoordinate = getCordinate(c.x, c.y, allDirection);
        let neighborElem = (matrix[neighborCoordinate.y] ?? [])[neighborCoordinate.x];
        if (neighborElem === element) {
            bla(neighborCoordinate, neighborElem, coordinateValues)
        } else {
            coo.fuucounter += 1;
            coo.fences.push({direction: allDirection, ...neighborCoordinate});
        }
    }
    return coordinateValues;
}

let x = 0;
for (const allElement of all) {

    const fences = allElement.flatMap(x => x.fences);
    const directionGroup = groupBy(fences, d => d.direction);

    let fenceSides = 0;

    directionGroup.forEach((va) => {
        const direction = va[0].direction;
        const groupKey = (direction === 'up' || direction === 'down') ? 'y' : 'x';
        const sequenceKey = (direction === 'up' || direction === 'down') ? 'x' : 'y';

        for (const eElement of groupBy(va, dd => dd[groupKey])) {
            let sortedSequence = eElement.map(s => s[sequenceKey]).sort();
            fenceSides += splitToSequences(sortedSequence).length;
        }
    });

    x += fenceSides * allElement.length;
}

console.log(x);
//844198 is ok
